<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ScanShield | Vulnerability Scanner</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: { "500": "#6366f1", "600": "#4f46e5" },
            secondary: { "500": "#10b981" },
            danger: { "500": "#ef4444" },
            warning: { "500": "#f59e0b" }
          }
        }
      }
    }
  </script>
  <style>
    .gradient-text {
      background: linear-gradient(90deg, #6366f1, #10b981);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .progress-ring__circle {
      transition: stroke-dashoffset 0.35s ease;
      transform: rotate(-90deg);
      transform-origin: 50% 50%;
    }
    .scan-card {
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    .scan-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15);
    }
    .severity-chip {
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
    }
    .animate-pulse {
      animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">

  <!-- Navigation -->
  <nav class="bg-white border-b border-gray-200 sticky top-0 z-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <div class="flex-shrink-0 flex items-center">
            <div class="h-8 w-8 rounded-md bg-primary-500 flex items-center justify-center text-white font-bold">SS</div>
            <span class="ml-2 text-xl font-bold text-gray-800">Scan<span class="gradient-text">Shield</span></span>
          </div>
          <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
            <a href="#" class="border-primary-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Dashboard</a>
            <a href="#" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Scans</a>
            <a href="#" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Reports</a>
          </div>
        </div>
        <div class="hidden sm:ml-6 sm:flex sm:items-center">
          <button class="p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
            <span class="sr-only">View notifications</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
            </svg>
          </button>
          <div class="ml-3 relative">
            <div class="h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 cursor-pointer">
              <span class="text-sm font-medium">JD</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-8">
      <h1 class="text-2xl font-bold text-gray-900">Website Vulnerability Scanner</h1>
      <p class="mt-1 text-gray-600">Comprehensive security assessment for your web applications</p>
    </div>

    <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
      <div class="p-6 border-b border-gray-200">
        <h2 class="text-lg font-medium text-gray-900">New Security Scan</h2>
      </div>
      <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          <div class="col-span-2">
            <label for="target-url" class="block text-sm font-medium text-gray-700 mb-1">Target URL</label>
            <div class="mt-1 flex rounded-md shadow-sm">
              <input type="url" id="target-url" class="focus:ring-primary-500 focus:border-primary-500 flex-1 block w-full rounded-none rounded-l-md sm:text-sm border-gray-300 p-2 border" placeholder="https://example.com" required>
              <button id="start-scan" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-r-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 animate-pulse">
                Scan Now
              </button>
            </div>
          </div>
          <div>
            <label for="scan-profile" class="block text-sm font-medium text-gray-700 mb-1">Scan Profile</label>
            <select id="scan-profile" class="focus:ring-primary-500 focus:border-primary-500 block w-full pl-3 pr-10 py-2 text-base border-gray-300 sm:text-sm rounded-md">
              <option value="full">Full Scan</option>
              <option value="quick">Quick Scan</option>
              <option value="xss">XSS Detection</option>
              <option value="sql">SQL Injection</option>
              <option value="csrf">CSRF Verification</option>
            </select>
          </div>
        </div>
        <div class="flex items-center">
          <input id="include-subdomains" type="checkbox" class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
          <label for="include-subdomains" class="ml-2 block text-sm text-gray-700">Include subdomains</label>
        </div>
      </div>
    </div>

    <!-- Scan Status Panel - Hidden by default -->
    <div id="scan-status" class="hidden bg-white rounded-lg shadow-md overflow-hidden mb-8">
      <div class="p-6 border-b border-gray-200">
        <h2 class="text-lg font-medium text-gray-900 flex items-center">
          <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-primary-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Scan in Progress
        </h2>
      </div>
      <div class="p-6">
        <div class="mb-4">
          <div class="flex justify-between text-sm text-gray-600 mb-1">
            <span>Scan progress</span>
            <span id="scan-percentage">0%</span>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2.5">
            <div id="progress-bar" class="bg-primary-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
            <div class="text-xs text-gray-500 mb-1">Current Test</div>
            <div id="current-test" class="text-sm font-medium text-gray-700">Initializing scanner</div>
          </div>
          <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
            <div class="text-xs text-gray-500 mb-1">Tests Completed</div>
            <div id="tests-completed" class="text-sm font-medium text-primary-600">0/24</div>
          </div>
          <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
            <div class="text-xs text-gray-500 mb-1">Identified Vulnerabilities</div>
            <div id="vulnerabilities-found" class="text-sm font-medium text-gray-700">0</div>
          </div>
        </div>
        <div id="current-test-details" class="mt-4 p-3 bg-gray-50 rounded-md text-sm">
          <!-- Test details will appear here -->
        </div>
      </div>
    </div>

    <!-- Results Dashboard - Hidden by default -->
    <div id="results-dashboard" class="hidden bg-white rounded-lg shadow-md overflow-hidden">
      <div class="p-6 border-b border-gray-200">
        <h2 class="text-lg font-medium text-gray-900">Scan Results</h2>
      </div>
      <div class="p-6">
        <div id="scan-summary" class="mb-8">
          <!-- Scan summary will appear here -->
        </div>
        <div id="vulnerability-list">
          <!-- Detailed vulnerabilities will appear here -->
        </div>
        <div class="mt-6">
          <button id="new-scan-btn" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
            Start New Scan
          </button>
        </div>
      </div>
    </div>

  </div>

  <!-- Improved JavaScript for Scan Functionality -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM Elements
      const startScanButton = document.getElementById('start-scan');
      const scanStatus = document.getElementById('scan-status');
      const progressBar = document.getElementById('progress-bar');
      const scanPercentage = document.getElementById('scan-percentage');
      const currentTest = document.getElementById('current-test');
      const testsCompleted = document.getElementById('tests-completed');
      const vulnerabilitiesFound = document.getElementById('vulnerabilities-found');
      const resultsDashboard = document.getElementById('results-dashboard');
      const targetUrlInput = document.getElementById('target-url');
      const currentTestDetails = document.getElementById('current-test-details');
      const newScanBtn = document.getElementById('new-scan-btn');
      const scanSummary = document.getElementById('scan-summary');
      const vulnerabilityList = document.getElementById('vulnerability-list');

      // Scan progress variables
      let scanInterval;
      let currentProgress = 0;
      const totalTests = 24;
      const scanTests = [
        "Initializing scanner",
        "Network configuration check",
        "DNS resolution test",
        "HTTP header analysis",
        "SSL/TLS configuration check",
        "Server software fingerprinting",
        "Directory listing check",
        "Robots.txt analysis",
        "Common file detection",
        "XSS vulnerability test",
        "SQL injection test",
        "CSRF vulnerability test",
        "Command injection test",
        "File inclusion test",
        "XXE injection test",
        "Authentication testing",
        "Session management check",
        "Password policy check",
        "Clickjacking test",
        "CORS policy check",
        "Content security policy check",
        "Clickjacking protection check",
        "Security headers check",
        "Finalizing results"
      ];

      // Start scan function
      startScanButton.addEventListener('click', startScan);
      newScanBtn.addEventListener('click', resetScanner);

      // Also allow Enter key to trigger scan
      targetUrlInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          startScan();
        }
      });

      function startScan() {
        const url = targetUrlInput.value.trim();
        const scanProfile = document.getElementById('scan-profile').value;
        const includeSubdomains = document.getElementById('include-subdomains').checked;

        // Validate URL
        if (!url) {
          showError("Please enter a target URL");
          return;
        }

        if (!isValidUrl(url)) {
          showError("Please enter a valid URL (include http:// or https://)");
          return;
        }

        // Reset any previous scans
        if (scanInterval) {
          clearInterval(scanInterval);
        }

        // Show scan status
        scanStatus.classList.remove('hidden');
        resultsDashboard.classList.add('hidden');
        currentProgress = 0;
        updateProgress(0);

        // Disable scan button during scan
        startScanButton.disabled = true;
        startScanButton.classList.remove('animate-pulse');
        startScanButton.classList.add('opacity-50');

        // Simulate scan progress
        scanInterval = setInterval(() => {
          if (currentProgress >= 100) {
            completeScan();
            return;
          }

          // Increment progress (random between 2-10%)
          const increment = 2 + Math.floor(Math.random() * 8);
          updateProgress(Math.min(currentProgress + increment, 100));

        }, 500 + Math.floor(Math.random() * 1000)); // Random interval between 500-1500ms
      }

      function updateProgress(newProgress) {
        currentProgress = newProgress;
        const currentTestIndex = Math.floor((currentProgress / 100) * (scanTests.length - 1));
        
        // Update progress bar
        progressBar.style.width = currentProgress + '%';
        scanPercentage.textContent = currentProgress + '%';
        
        // Update test information
        currentTest.textContent = scanTests[currentTestIndex];
        testsCompleted.textContent = Math.floor((currentProgress / 100) * totalTests) + '/' + totalTests;
        
        // Random vulnerability count (for simulation)
        const vulnCount = currentProgress > 90 ? 
          Math.floor(Math.random() * 5) : 
          Math.floor(currentProgress / 35);
        
        vulnerabilitiesFound.textContent = vulnCount;
        
        // Show detailed test info (every 10%)
        if (currentProgress % 10 === 0 || currentProgress === 100) {
          const testDetails = generateTestDetails(currentTestIndex, vulnCount);
          currentTestDetails.innerHTML = testDetails;
        }
      }

      function generateTestDetails(testIndex, vulnCount) {
        const testName = scanTests[testIndex];
        let details = <div class="font-medium text-gray-800 mb-1">${testName}</div>;
        
        if (vulnCount > 0 && testIndex > 5) {
          details += `
            <div class="mt-2">
              <span class="inline-block bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full">${vulnCount} issue${vulnCount > 1 ? 's' : ''} found</span>
              <ul class="mt-1 text-gray-600 text-xs list-disc list-inside">
                <li>Potential ${getRandomVulnerabilityType()}</li>
                ${vulnCount > 1 ? '<li>Weak configuration detected</li>' : ''}
              </ul>
            </div>
          `;
        } else if (testIndex > 0) {
          details += '<div class="mt-1 text-green-600 text-xs">No issues detected</div>';
        }
        
        return details;
      }

      function getRandomVulnerabilityType() {
        const types = [
          "XSS vulnerability",
          "insecure header",
          "information disclosure",
          "missing security header",
          "directory listing enabled",
          "outdated software version"
        ];
        return types[Math.floor(Math.random() * types.length)];
      }

      function completeScan() {
        clearInterval(scanInterval);
        
        // Update final status
        currentTest.textContent = "Scan completed";
        progressBar.style.width = '100%';
        scanPercentage.textContent = '100%';
        testsCompleted.textContent = totalTests + '/' + totalTests;
        currentTestDetails.innerHTML = '<div class="text-green-600 font-medium">Scan completed successfully</div>';

        // Re-enable scan button
        setTimeout(() => {
          scanStatus.classList.add('hidden');
          resultsDashboard.classList.remove('hidden');
          showScanResults();
          startScanButton.disabled = false;
          startScanButton.classList.remove('opacity-50');
          startScanButton.classList.add('animate-pulse');
        }, 1500);
      }

      function showScanResults() {
        const url = targetUrlInput.value.trim();
        const profile = document.getElementById('scan-profile').options[
          document.getElementById('scan-profile').selectedIndex
        ].text;
        
        const totalVulns = Math.floor(Math.random() * 6); // 0-5 vulnerabilities
        const severity = totalVulns === 0 ? 'low' : 
                       (totalVulns < 3 ? 'medium' : 'high');
        
        // Generate summary
        scanSummary.innerHTML = `
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-4">
            <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
              <div class="text-xs text-gray-500 mb-1">Scanned URL</div>
              <div class="text-sm font-medium text-gray-700 break-all">${url}</div>
            </div>
            <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
              <div class="text-xs text-gray-500 mb-1">Scan Profile</div>
              <div class="text-sm font-medium text-gray-700">${profile}</div>
            </div>
            <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
              <div class="text-xs text-gray-500 mb-1">Severity</div>
              <div class="text-sm font-medium text-${severity === 'high' ? 'red' : severity === 'medium' ? 'orange' : 'green'}-600">
                ${severity.charAt(0).toUpperCase() + severity.slice(1)} risk
              </div>
            </div>
          </div>
          <div class="p-4 bg-${severity === 'high' ? 'red' : severity === 'medium' ? 'yellow' : 'green'}-50 rounded-md border border-${severity === 'high' ? 'red' : severity === 'medium' ? 'yellow' : 'green'}-200">
            <div class="text-${severity === 'high' ? 'red' : severity === 'medium' ? 'yellow' : 'green'}-800">
              <span class="font-medium">Scan summary:</span> Found ${totalVulns} security ${totalVulns === 1 ? 'issue' : 'issues'}
            </div>
          </div>
        `;
        
        // Generate vulnerability list (if any)
        if (totalVulns > 0) {
          let vulnItems = '';
          for (let i = 0; i < totalVulns; i++) {
            const vulnType = getRandomVulnerabilityType();
            vulnItems += `
              <div class="mb-4 p-4 border border-gray-200 rounded-md hover:bg-gray-50">
                <div class="flex justify-between items-start">
                  <div class="font-medium text-gray-800">${vulnType}</div>
                  <span class="text-xs px-2 py-1 rounded-full bg-${
                    vulnType.includes('XSS') || vulnType.includes('SQL') ? 'red' : 'orange'
                  }-100 text-${vulnType.includes('XSS') || vulnType.includes('SQL') ? 'red' : 'orange'}-800">
                    ${vulnType.includes('XSS') || vulnType.includes('SQL') ? 'High' : 'Medium'} risk
                  </span>
                </div>
                <div class="mt-1 text-sm text-gray-600">
                  ${getVulnerabilityDescription(vulnType)}
                </div>
                <div class="mt-2">
                  <span class="text-xs text-gray-500">Location:</span>
                  <code class="text-xs bg-gray-100 px-2 py-1 rounded ml-1">/${getRandomEndpoint()}</code>
                </div>
              </div>
            `;
          }
          vulnerabilityList.innerHTML = `
            <div class="mb-4">
              <h3 class="text-lg font-medium text-gray-900">Identified Vulnerabilities</h3>
              <div class="mt-4">
                ${vulnItems}
              </div>
            </div>
          `;
        } else {
          vulnerabilityList.innerHTML = `
            <div class="text-center py-8">
              <svg class="mx-auto h-12 w-12 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              <h3 class="mt-2 text-lg font-medium text-gray-900">No critical vulnerabilities found</h3>
              <p class="mt-1 text-gray-600">Your website appears to be well-secured against common web vulnerabilities.</p>
            </div>
          `;
        }
      }

      function getVulnerabilityDescription(type) {
        const descriptions = {
          "XSS vulnerability": "Cross-site scripting vulnerability allows attackers to inject client-side scripts into web pages viewed by other users.",
          "insecure header": "Missing or misconfigured security headers that could expose your site to attacks.",
          "information disclosure": "The server is revealing sensitive information that could be useful to attackers.",
          "missing security header": "Important security headers are missing, potentially exposing your site to various attacks.",
          "directory listing enabled": "Directory listing is enabled, which could expose sensitive files to attackers.",
          "outdated software version": "The server is running an outdated version with known vulnerabilities."
        };
        return descriptions[type] || "A potential security issue was identified that should be addressed.";
      }

      function getRandomEndpoint() {
        const endpoints = [
          "admin/login.php",
          "api/v1/users",
          "wp-admin",
          "config.ini",
          "search?q=",
          "user/profile"
        ];
        return endpoints[Math.floor(Math.random() * endpoints.length)];
      }

      function resetScanner() {
        resultsDashboard.classList.add('hidden');
        targetUrlInput.focus();
      }

      function showError(message) {
        alert(message); // In a real app you might show a nicer error UI
        targetUrlInput.focus();
      }

      function isValidUrl(string) {
        try {
          new URL(string);
          return true;
        } catch (err) {
          return false;
        }
      }
    });
  </script>
</body>
</html>